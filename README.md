# Exploiting en Windows

### Day 1 - Exploiting in Windows

1. Introduction
2. Vulnerabilities vs bugs
3. Types of vulnerabilities
4. The stack
   1. Stack frames
5. Stack buffer overflow
   1. Immunity Debugger
   2. Demos

### Day 2 - Saved EIP vs SEH

1. Overwriting the return address
   1. Saved EIP
      1. About shellcodes
      2. Fixed addresses
      3. Dynamic addresses
      4. Demos (Immunity Debugger + mona.py)
2. Structure Exception Handling (SEH)        
   1. Exploiting SEH
      1. Demo (CVE-2009-1831, Winamp, Windows XP/7 SP1)
   2. Homework (CVE-2011-0257, QuickTime, Windows XP/7 SP1, MSF Meterpreter)

### Day 3 - Mitigation Techniques (I)

1. SafeSEH
2. Structured Exception Handling Overwrite Protection (SEHOP)
3. Stack Cookies

### Day 4 - Mitigation Techniques (II)

1. Data Execution Prevention (DEP)
   1. Return Oriented Programming (ROP)
   2. Demo (CVE-2008-5405, Cain, Windows 8.1, ROPGadget, mona.py)
2. Address Space Layout Randomization (ASLR)
   1. Partial Overwrite
   2. Bruteforce
   3. Avoiding ASLR
   4. Spraying
   5. SharedUserData Leak
   6. Information Leaks
   7. Final Notes
3. Exploiting nowadays

### Demos

#### Exploit by overwriting sEIP and SEH


1. cve-2008-1831_winamp (SEH)
    equal in xpsp3 and win7sp1

2. cve-2008-5405_cain (sEIP)
    change module to exploit it in win7sp1

3. cve-2011-0257_quicktime
    can't be done without overwriting seip (libdispatch.dll without dep nor aslr, but safeseh)

4. cve-2012-5691_realplayer
    can't be exploited without infoleak (all aslr+dep)

#### Exploit bypassing DEP in Windows 8.1 PRO

1. cve-2008-1831_winamp
    (set DEP as OptOut: $ bcdedit /set nx OptOut)# New Document
